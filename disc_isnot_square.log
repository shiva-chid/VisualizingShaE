> 
> FF := Rationals();
> 
> // ternary cubic with coefficients of x^3, y^3 and z^3 equal to 1
> // and discriminant of the cubic polynomial obtained by intersecting with a general line
> PF<xi1,xi2,xi3,xi4,xi5,xi6,xi7,xi8,xi9,xi10,a2,b1,c1,c2,m> := PolynomialRing(FF,15);
> // PF<xi1,xi2,xi3,xi4,xi5,xi6,xi7,xi8,xi9,xi10,a,b,a2,b1,c1,c2,m> := PolynomialRing(FF,17);
> xi := [xi1, xi2, xi3, xi4, xi5, xi6, xi7, xi8, xi9, xi10];
> P<alpha,beta> := PolynomialRing(PF,2);
> P3<x,y,z> := PolynomialRing(P,3);
> P1<t> := PolynomialRing(P);
> f := x^3+y^3+z^3+a2*x^2*y+b1*y^2*x+c1*z^2*x+c2*z^2*y+m*x*y*z;
> // f := a*x^3+b*y^3+z^3+a2*x^2*y+b1*y^2*x+c1*z^2*x+c2*z^2*y+m*x*y*z;
> g := Evaluate(f,z,alpha*x+beta*y);
> g_t := Evaluate(g,[t,1,0]);
> disc := Discriminant(g_t);
> 
> // conditions for the discriminant to be a square of a polynomial in Qbar[alpha,beta]
> mons := &join[MonomialsOfDegree(P,i) : i in [0..3]];
> assert #mons eq 10;
> general_sqpoly := (&+[xi[i]*mons[i] : i in [1..#mons]])^2;
> wantzero := Coefficients(disc - general_sqpoly);
> assert #wantzero eq 28;
> I := ideal<PF | wantzero>;
> X := Scheme(AffineSpace(PF),I);
> time dimX := Dimension(X); dimX;
Time: 77.220
2
> time GBI := GroebnerBasis(I); #GBI;
Time: 8571.620
367
> 
> // Define ideal of relations in a2,b1,c1,c2,m
> somepols := [x : x in GBI | { Degree(x,PF.j) : j in [1..10] } eq {0}]; #somepols;
144
> A5<A2,B1,C1,C2,M> := AffineSpace(FF,5);
> P5 := CoordinateRing(A5);
> h := hom<PF->P5|[0 : i in [1..10]] cat [A2,B1,C1,C2,M]>;
> I5 := ideal<P5|[h(pol) : pol in somepols]>;
> I5rad := Radical(I5);
> time GBI5 := GroebnerBasis(I5rad); #GBI5;
Time: 0.000
20
> XX := Scheme(A5,I5rad);
> dimXX := Dimension(XX); dimXX;
2
> XX;
Scheme over Rational Field defined by
A2 - 1/3*B1^2 - 1/3*C1*M,
B1^3 + B1*C1^2*C2 - 2*C1^3 - C1^2*C2^2*M + 2*C1*C2*M^2 - C2^3 - M^3 - 27,
B1^2*C1^2 + 4/35*B1*C1*M^5 + 2/5*B1*C1*M^2 - 4/315*B1*C2^11 - 16/315*B1*C2^8*M^3 + 2/35*B1*C2^8 - 32/315*B1*C2^5*M^3 - 2/5*B1*C2^5 + 16/315*B1*C2^2*M^6 - 2/35*B1*C2^2*M^3 + 3*B1*C2^2 + 8/315*C1^5*C2^5*M^2 + 4/63*C1^5*C2^2*M^2 + 16/315*C1^4*C2^7*M^3 - 4/315*C1^4*C2^7 + 16/105*C1^4*C2^4*M^3 + 2/35*C1^4*C2^4 + 8/105*C1^4*C2*M^3 - 2/5*C1^4*C2 + 8/315*C1^3*C2^9*M^4 - 8/315*C1^3*C2^9*M + 4/315*C1^3*C2^6*M^4 + 4/63*C1^3*C2^6*M - 8/105*C1^3*C2^3*M^4 - 4/7*C1^3*C2^3*M + 4/35*C1^3*M^4 + 12/5*C1^3*M - 4/315*C1^2*C2^11*M^2 - 8/105*C1^2*C2^8*M^5 - 2/45*C1^2*C2^8*M^2 - 8/45*C1^2*C2^5*M^5 - 146/315*C1^2*C2^5*M^2 + 8/105*C1^2*C2^2*M^5 + 15/7*C1^2*C2^2*M^2 + 16/315*C1*C2^10*M^3 + 16/315*C1*C2^10 + 8/105*C1*C2^7*M^6 + 32/45*C1*C2^7*M^3 - 8/35*C1*C2^7 + 4/21*C1*C2^4*M^6 + 68/35*C1*C2^4*M^3 + 8/5*C1*C2^4 - 4/105*C1*C2*M^6 - 14/5*C1*C2*M^3 - 18*C1*C2 - 4/315*C2^12*M - 4/105*C2^9*M^4 - 38/315*C2^9*M - 8/315*C2^6*M^7 - 242/315*C2^6*M^4 + 2/5*C2^6*M - 8/105*C2^3*M^7 - 12/7*C2^3*M^4 - 13/5*C2^3*M + M^4 + 27*M,
B1^2*C1*C2 - 3/2*B1^2*M - 3/2*B1*C1^2 - 1/2*C1^2*C2*M - 9/2*C2^2,
B1^2*C1*M + B1*C1^3 + 4*B1*C1*C2*M^2 + 2*B1*C2^3 - 4*B1*M^3 + 3*C1^3*C2*M + 2*C1^2*C2^3*M^2 - 4*C1^2*M^2 - 4*C1*C2^2*M^3 - 9*C1*C2^2 + 2*C2^4*M + 2*C2*M^4 + 18*C2*M,
B1^2*C2^2 - 6*B1*C1*C2 + 9*B1*M + 9*C1^2 + 4*C1*C2^2*M - 3*C2*M^2,
B1^2*C2*M - 3*B1*C1^2*C2 + 6*B1*C1*M + 6*C1^3 + 3*C1^2*C2^2*M - 2*C1*C2*M^2 + 3*C2^3,
B1^2*M^2 + 2*B1*C1^2*M + 2*B1*C1*C2^2*M^2 + B1*C2^4 - 2*B1*C2*M^3 + C1^4 + 2*C1^3*C2^2*M + C1^2*C2^4*M^2 - 2*C1^2*C2*M^2 - 2*C1*C2^3*M^3 - 4*C1*C2^3 + C2^5*M + C2^2*M^4 + 12*C2^2*M,
B1*C1^4 + 2*B1*C1*C2^3 + 4/35*B1*C1*M^6 + 2/5*B1*C1*M^3 - 4/315*B1*C2^11*M - 16/315*B1*C2^8*M^4 + 2/35*B1*C2^8*M - 32/315*B1*C2^5*M^4 - 2/5*B1*C2^5*M + 16/315*B1*C2^2*M^7 - 2/35*B1*C2^2*M^4 - 3*B1*C2^2*M + 8/315*C1^5*C2^5*M^3 + 4/63*C1^5*C2^2*M^3 + 16/315*C1^4*C2^7*M^4 - 4/315*C1^4*C2^7*M + 16/105*C1^4*C2^4*M^4 + 2/35*C1^4*C2^4*M + 8/105*C1^4*C2*M^4 + 13/5*C1^4*C2*M + 8/315*C1^3*C2^9*M^5 - 8/315*C1^3*C2^9*M^2 + 4/315*C1^3*C2^6*M^5 + 4/63*C1^3*C2^6*M^2 - 8/105*C1^3*C2^3*M^5 + 10/7*C1^3*C2^3*M^2 + 4/35*C1^3*M^5 - 8/5*C1^3*M^2 - 4/315*C1^2*C2^11*M^3 - 8/105*C1^2*C2^8*M^6 - 2/45*C1^2*C2^8*M^3 - 8/45*C1^2*C2^5*M^6 - 146/315*C1^2*C2^5*M^3 + 8/105*C1^2*C2^2*M^6 - 27/7*C1^2*C2^2*M^3 - 9*C1^2*C2^2 + 16/315*C1*C2^10*M^4 + 16/315*C1*C2^10*M + 8/105*C1*C2^7*M^7 + 32/45*C1*C2^7*M^4 - 8/35*C1*C2^7*M + 4/21*C1*C2^4*M^7 + 68/35*C1*C2^4*M^4 + 18/5*C1*C2^4*M - 4/105*C1*C2*M^7 + 16/5*C1*C2*M^4 + 36*C1*C2*M - 4/315*C2^12*M^2 - 4/105*C2^9*M^5 - 38/315*C2^9*M^2 - 8/315*C2^6*M^8 - 242/315*C2^6*M^5 + 2/5*C2^6*M^2 - 8/105*C2^3*M^8 - 12/7*C2^3*M^5 - 23/5*C2^3*M^2 - M^5 - 27*M^2,
B1*C1^3*C2 - 3/2*B1*C1^2*M + B1*C1*C2^2*M^2 + 1/2*B1*C2^4 - B1*C2*M^3 - 3/2*C1^4 + 1/2*C1^2*C2^4*M^2 - 1/2*C1^2*C2*M^2 - C1*C2^3*M^3 - 3*C1*C2^3 + 1/2*C2^5*M + 1/2*C2^2*M^4 + 9/2*C2^2*M,
B1*C1^3*M + B1*C1*C2^4 + 2*B1*C1*C2*M^3 - 2*B1*C2^3*M - 2*B1*M^4 + C1^5 + 2*C1^4*C2^2*M + C1^3*C2^4*M^2 - C1^3*C2*M^2 - 2*C1^2*C2^3*M^3 - 4*C1^2*C2^3 - 2*C1^2*M^3 + C1*C2^5*M + C1*C2^2*M^4 + 21*C1*C2^2*M - 18*C2*M^2,
B1*C1^2*C2^2 - 4*B1*C1*C2*M + 3*B1*M^2 - 2*C1^3*C2 - C1^2*C2^3*M + 3*C1^2*M + 2*C1*C2^2*M^2 - C2^4 - C2*M^3,
B1*C1^2*C2*M - 2/35*B1*C1*M^5 - 6/5*B1*C1*M^2 + 2/315*B1*C2^11 + 8/315*B1*C2^8*M^3 - 1/35*B1*C2^8 + 16/315*B1*C2^5*M^3 + 1/5*B1*C2^5 - 8/315*B1*C2^2*M^6 + 1/35*B1*C2^2*M^3 - 4/315*C1^5*C2^5*M^2 - 2/63*C1^5*C2^2*M^2 - 8/315*C1^4*C2^7*M^3 + 2/315*C1^4*C2^7 - 8/105*C1^4*C2^4*M^3 - 1/35*C1^4*C2^4 - 4/105*C1^4*C2*M^3 + 1/5*C1^4*C2 - 4/315*C1^3*C2^9*M^4 + 4/315*C1^3*C2^9*M - 2/315*C1^3*C2^6*M^4 - 2/63*C1^3*C2^6*M + 4/105*C1^3*C2^3*M^4 + 2/7*C1^3*C2^3*M - 2/35*C1^3*M^4 - 6/5*C1^3*M + 2/315*C1^2*C2^11*M^2 + 4/105*C1^2*C2^8*M^5 + 1/45*C1^2*C2^8*M^2 + 4/45*C1^2*C2^5*M^5 + 73/315*C1^2*C2^5*M^2 - 4/105*C1^2*C2^2*M^5 - 4/7*C1^2*C2^2*M^2 - 8/315*C1*C2^10*M^3 - 8/315*C1*C2^10 - 4/105*C1*C2^7*M^6 - 16/45*C1*C2^7*M^3 + 4/35*C1*C2^7 - 2/21*C1*C2^4*M^6 - 34/35*C1*C2^4*M^3 - 4/5*C1*C2^4 + 2/105*C1*C2*M^6 + 2/5*C1*C2*M^3 + 2/315*C2^12*M + 2/105*C2^9*M^4 + 19/315*C2^9*M + 4/315*C2^6*M^7 + 121/315*C2^6*M^4 - 1/5*C2^6*M + 4/105*C2^3*M^7 + 6/7*C2^3*M^4 + 9/5*C2^3*M,
B1*C1^2*M^2 + 2/3*B1*C1*C2^5 + 2/3*B1*C1*C2^2*M^3 - 5/3*B1*C2^4*M - 2/3*B1*C2*M^4 + 2/3*C1^5*C2 + 4/3*C1^4*C2^3*M + C1^4*M + 2/3*C1^3*C2^5*M^2 - 2/3*C1^3*C2^2*M^2 - 5/3*C1^2*C2^4*M^3 - 8/3*C1^2*C2^4 - C1^2*C2*M^3 + 2/3*C1*C2^6*M + 4/3*C1*C2^3*M^4 + 16*C1*C2^3*M - 1/3*C2^5*M^2 - 1/3*C2^2*M^5 - 15*C2^2*M^2,
B1*C1*C2^6 - 2/35*B1*C1*M^6 + 9/5*B1*C1*M^3 + 2/315*B1*C2^11*M + 8/315*B1*C2^8*M^4 - 1/35*B1*C2^8*M + 16/315*B1*C2^5*M^4 - 14/5*B1*C2^5*M - 8/315*B1*C2^2*M^7 + 1/35*B1*C2^2*M^4 - 4/315*C1^5*C2^5*M^3 - 2/63*C1^5*C2^2*M^3 + C1^5*C2^2 - 8/315*C1^4*C2^7*M^4 + 2/315*C1^4*C2^7*M - 8/105*C1^4*C2^4*M^4 + 69/35*C1^4*C2^4*M - 4/105*C1^4*C2*M^4 + 6/5*C1^4*C2*M - 4/315*C1^3*C2^9*M^5 + 4/315*C1^3*C2^9*M^2 - 2/315*C1^3*C2^6*M^5 + 61/63*C1^3*C2^6*M^2 + 4/105*C1^3*C2^3*M^5 - 12/7*C1^3*C2^3*M^2 - 2/35*C1^3*M^5 + 9/5*C1^3*M^2 + 2/315*C1^2*C2^11*M^3 + 4/105*C1^2*C2^8*M^6 + 1/45*C1^2*C2^8*M^3 + 4/45*C1^2*C2^5*M^6 - 872/315*C1^2*C2^5*M^3 - 4*C1^2*C2^5 - 4/105*C1^2*C2^2*M^6 + 3/7*C1^2*C2^2*M^3 - 8/315*C1*C2^10*M^4 - 8/315*C1*C2^10*M - 4/105*C1*C2^7*M^7 - 16/45*C1*C2^7*M^4 + 39/35*C1*C2^7*M - 2/21*C1*C2^4*M^7 + 71/35*C1*C2^4*M^4 + 126/5*C1*C2^4*M + 2/105*C1*C2*M^7 - 3/5*C1*C2*M^4 + 2/315*C2^12*M^2 + 2/105*C2^9*M^5 + 19/315*C2^9*M^2 + 4/315*C2^6*M^8 + 121/315*C2^6*M^5 - 6/5*C2^6*M^2 + 4/105*C2^3*M^8 - 1/7*C2^3*M^5 - 126/5*C2^3*M^2,
B1*C1*C2^3*M^2 + 1/7*B1*C1*M^5 - 1/63*B1*C2^11 - 4/63*B1*C2^8*M^3 + 1/14*B1*C2^8 - 8/63*B1*C2^5*M^3 + 4/63*B1*C2^2*M^6 - 15/14*B1*C2^2*M^3 + 2/63*C1^5*C2^5*M^2 + 5/63*C1^5*C2^2*M^2 + 4/63*C1^4*C2^7*M^3 - 1/63*C1^4*C2^7 + 4/21*C1^4*C2^4*M^3 + 1/14*C1^4*C2^4 + 2/21*C1^4*C2*M^3 + 2/63*C1^3*C2^9*M^4 - 2/63*C1^3*C2^9*M + 1/63*C1^3*C2^6*M^4 + 5/63*C1^3*C2^6*M - 2/21*C1^3*C2^3*M^4 + 2/7*C1^3*C2^3*M + 1/7*C1^3*M^4 - 1/63*C1^2*C2^11*M^2 - 2/21*C1^2*C2^8*M^5 - 1/18*C1^2*C2^8*M^2 - 2/9*C1^2*C2^5*M^5 - 5/63*C1^2*C2^5*M^2 + 2/21*C1^2*C2^2*M^5 - 15/14*C1^2*C2^2*M^2 + 4/63*C1*C2^10*M^3 + 4/63*C1*C2^10 + 2/21*C1*C2^7*M^6 + 8/9*C1*C2^7*M^3 - 2/7*C1*C2^7 + 5/21*C1*C2^4*M^6 + 10/7*C1*C2^4*M^3 - 1/21*C1*C2*M^6 - 1/63*C2^12*M - 1/21*C2^9*M^4 - 19/126*C2^9*M - 2/63*C2^6*M^7 - 121/126*C2^6*M^4 + C2^6*M - 2/21*C2^3*M^7 - 23/14*C2^3*M^4,
B1*C1*C2*M^5 - 49*B1*C1*C2*M^2 + 1/2*B1*C2^9 + 2*B1*C2^6*M^3 - 7/2*B1*C2^6 - 1/2*B1*C2^3*M^3 - 3*B1*M^6 + 105/2*B1*M^3 - C1^5*C2^3*M^2 - 2*C1^4*C2^5*M^3 + 1/2*C1^4*C2^5 - C1^4*C2^2*M^3 - 7/2*C1^4*C2^2 - C1^3*C2^7*M^4 + C1^3*C2^7*M + 2*C1^3*C2^4*M^4 - 5*C1^3*C2^4*M - C1^3*C2*M^4 - 14*C1^3*C2*M + 1/2*C1^2*C2^9*M^2 + 3*C1^2*C2^6*M^5 + 1/2*C1^2*C2^6*M^2 - 15/2*C1^2*C2^3*M^2 - 3*C1^2*M^5 + 105/2*C1^2*M^2 - 2*C1*C2^8*M^3 - 2*C1*C2^8 - 3*C1*C2^5*M^6 - 23*C1*C2^5*M^3 + 14*C1*C2^5 - C1*C2^2*M^6 + 28*C1*C2^2*M^3 + 1/2*C2^10*M + 3/2*C2^7*M^4 + 7/2*C2^7*M + C2^4*M^7 + 27*C2^4*M^4 - 49*C2^4*M + C2*M^7 - 35/2*C2*M^4,
B1*C1*M^8 - 49*B1*C1*M^5 - 1/9*B1*C2^11*M^3 + 35/18*B1*C2^11 - 4/9*B1*C2^8*M^6 + 149/18*B1*C2^8*M^3 - 8/9*B1*C2^5*M^6 + 847/18*B1*C2^5*M^3 + 4/9*B1*C2^2*M^9 - 149/18*B1*C2^2*M^6 + 2/9*C1^5*C2^5*M^5 - 35/9*C1^5*C2^5*M^2 + 5/9*C1^5*C2^2*M^5 - 245/9*C1^5*C2^2*M^2 + 4/9*C1^4*C2^7*M^6 - 71/9*C1^4*C2^7*M^3 + 35/18*C1^4*C2^7 + 4/3*C1^4*C2^4*M^6 - 347/6*C1^4*C2^4*M^3 + 2/3*C1^4*C2*M^6 - 98/3*C1^4*C2*M^3 + 2/9*C1^3*C2^9*M^7 - 37/9*C1^3*C2^9*M^4 + 35/9*C1^3*C2^9*M + 1/9*C1^3*C2^6*M^7 - 170/9*C1^3*C2^6*M^4 + 70/9*C1^3*C2^6*M - 2/3*C1^3*C2^3*M^7 + 125/3*C1^3*C2^3*M^4 + C1^3*M^7 - 49*C1^3*M^4 - 1/9*C1^2*C2^11*M^5 + 35/18*C1^2*C2^11*M^2 - 2/3*C1^2*C2^8*M^8 + 203/18*C1^2*C2^8*M^5 + 140/9*C1^2*C2^8*M^2 - 14/9*C1^2*C2^5*M^8 + 227/3*C1^2*C2^5*M^5 + 1435/18*C1^2*C2^5*M^2 + 2/3*C1^2*C2^2*M^8 - 115/6*C1^2*C2^2*M^5 + 4/9*C1*C2^10*M^6 - 22/3*C1*C2^10*M^3 - 70/9*C1*C2^10 + 2/3*C1*C2^7*M^9 - 49/9*C1*C2^7*M^6 - 1313/9*C1*C2^7*M^3 + 5/3*C1*C2^4*M^9 - 194/3*C1*C2^4*M^6 - 686*C1*C2^4*M^3 - 1/3*C1*C2*M^9 + 49/3*C1*C2*M^6 - 1/9*C2^12*M^4 + 35/18*C2^12*M - 1/3*C2^9*M^7 + 43/9*C2^9*M^4 + 245/9*C2^9*M - 2/9*C2^6*M^10 - 17/6*C2^6*M^7 + 2653/18*C2^6*M^4 - 2/3*C2^3*M^10 + 85/6*C2^3*M^7 + 686*C2^3*M^4,
B1*C2^12 + 4*B1*C2^9*M^3 + 26*B1*C2^6*M^3 - 4*B1*C2^3*M^6 - 27*B1*M^6 - 2*C1^5*C2^6*M^2 - 14*C1^5*C2^3*M^2 - 4*C1^4*C2^8*M^3 + C1^4*C2^8 - 30*C1^4*C2^5*M^3 - 15*C1^4*C2^2*M^3 - 2*C1^3*C2^10*M^4 + 2*C1^3*C2^10*M - 10*C1^3*C2^7*M^4 + 4*C1^3*C2^7*M + 24*C1^3*C2^4*M^4 - 18*C1^3*C2*M^4 + C1^2*C2^12*M^2 + 6*C1^2*C2^9*M^5 + 8*C1^2*C2^9*M^2 + 41*C1^2*C2^6*M^5 + 41*C1^2*C2^6*M^2 - 6*C1^2*C2^3*M^5 - 27*C1^2*M^5 - 4*C1*C2^11*M^3 - 4*C1*C2^11 - 6*C1*C2^8*M^6 - 74*C1*C2^8*M^3 - 42*C1*C2^5*M^6 - 360*C1*C2^5*M^3 - 6*C1*C2^2*M^6 + C2^13*M + 3*C2^10*M^4 + 14*C2^10*M + 2*C2^7*M^7 + 74*C2^7*M^4 + 15*C2^4*M^7 + 378*C2^4*M^4 + 9*C2*M^7,
C1^6 + 2*C1^5*C2^2*M + C1^4*C2^4*M^2 - 4*C1^4*C2*M^2 - 4*C1^3*C2^3*M^3 - 2*C1^3*C2^3 + 2*C1^3*M^3 + 2*C1^2*C2^5*M + 6*C1^2*C2^2*M^4 + 27*C1^2*C2^2*M - 4*C1*C2^4*M^2 - 4*C1*C2*M^5 - 54*C1*C2*M^2 + C2^6 + 2*C2^3*M^3 + M^6 + 27*M^3
> 
> // Define Genus One Model
> Model := GenusOneModel(f);
> 
> // This returns the standard degree 12 invariant Delta
> Delta_K := h(Discriminant(Model));
> 
> // Check against relations
> Delta_K in I5;
true
> Delta_K in I5rad;
true
